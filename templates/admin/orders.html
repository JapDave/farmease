{% extends 'admin/index_base.html' %}
{% load static %}
{% load i18n %}
{% load tagger %}
{% block title %}Orders{% endblock title %}

{% block head %}

<script>
   $(document).ready(function () {    
      $('#dtBasicExample').DataTable({
      lengthChange:true,
      searching: true,
      paging:false,
      });
   });
</script>   
{% endblock head %}

{% block body %}
   <div class="container-fluid">
      <div class="row">

         <!-- Area Chart -->
         <div class="col-xl-12 col-lg-12">
             <div class="card shadow mb-4">
                 <!-- Card Header - Dropdown -->
                 <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                     <h5 class="m-0 font-weight-bold text-primary">{% trans 'Show Orders' %}</h5> 
                 </div>
                 <!-- Card Body -->
                 <div class="card-body">
                     <div class="chart-area">
                        {% if msg %}
                           <p class="text-danger">{{msg}}</p>
                           {% else %}
                              <div>
                                 <form method="GET" name="form" action="{% url 'admin_allorder' %}">
                                    {% csrf_token %}
                                    <select name="selected_farmer" class="farmer-select" onchange="this.form.submit()">                                      
                                          <option value="" disabled selected>Select Farmer</option>
                                       {% for farmer in farmers %}
                                          <option {% if selected_farmer == farmer|get_item:'_id'%}selected{% endif %} value = {{farmer|get_item:'_id'}}>{{farmer.first_name}}</option>
                                       {% endfor %}
                                    </select>   
                                 </form>          
                              </div>
                             
                              <table id="dtBasicExample" class="table table-striped table-bordered" style="width:100%">
                                 <thead>
                                    <tr>
                                       <th> Sr.No </th>
                                       <th>Customer</th>
                                       <th>Total Amount</th>
                                       <th>status</th>
                                       <th>Detail</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    {% for order in orders %}
                                       <tr>
                                          <td>{{forloop.counter}}</td>
                                          <td>{{order.customer.first_name}}</td>
                                          <td>{{order.total}}</td>      
                                          {% if order.status == '0' %}<td>pending</td>{% endif %}    
                                          {% if order.status == '1' %}<td>approved</td>{% endif %}     
                                          {% if order.status == '2' %}<td>dispatched</td>{% endif %}     
                                          {% if order.status == '3' %}<td>delievered</td>{% endif %}     
                                          {% if order.status == '4' %}<td>cancelled</td>{% endif %}    
                                          <td class="text-center pointer"><a href="{% url 'admin_detailorder' order|get_item:'_id' %}"><i class="fas fa-info-circle"></i></i></a></td>      
                                       </tr>
                                    {% endfor %}
                                 </tbody>   
                              </table>
                        {% endif %}   
                     </div>
                 </div>
             </div>
         </div>
      </div>  
       <div >
            {% if results.has_other_pages %}
            <ul class="pagination">
               {% if results.has_previous %}
               <li><a href="?page={{ results.previous_page_number }}">&laquo;</a></li>
               {% else %}
               <li class="disabled"><span>&laquo;</span></li>
               {% endif %}
               {% for i in results.paginator.page_range %}
               {% if results.number == i %}
               <li class="active"><span>{{ i }} <span class=""></span></span></li>
               {% else %}
               <li><a href="?page={{ i }}">{{ i }}</a></li>
               {% endif %}
               {% endfor %}
               {% if results.has_next %}
               <li><a href="?page={{ results.next_page_number }}">&raquo;</a></li>
               {% else %}
               <li class="disabled"><span>&raquo;</span></li>
               {% endif %}
            </ul>
            {% endif %}
         </div>
      </div>
   </div>

{% endblock body %}
